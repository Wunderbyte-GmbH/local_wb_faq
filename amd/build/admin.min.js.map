{"version":3,"file":"admin.min.js","sources":["../src/admin.js"],"sourcesContent":["\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @package    local_wunderbyte_table\n * @copyright  Wunderbyte GmbH <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\nimport Templates from 'core/templates';\nimport DynamicForm from 'core_form/dynamicform';\nimport {confirmDeleteEntry} from 'local_wb_faq/edit';\n\n/**\n * Gets called from mustache template.\n * @param {*} data\n */\nexport const init = (data) => {\n\n    addEvents(data);\n    renderforcache(data);\n};\n\n/**\n * adds Evente to toggle switch\n * @param {*} data\n */\nfunction addEvents(data) {\n    let select = document.getElementById('local_wb_faq_admin');\n    select.addEventListener('click', (e) => {\n        if (e.target.hasAttribute('data-action')) {\n            e.target.setAttribute('disabled', 'disabled');\n            if (e.target.dataset.action == \"goto\") {\n\n                render(e.target.dataset.targetid, data);\n            }\n            if (e.target.dataset.action == \"quickedit\") {\n\n                renderedit(e.target.dataset.targetid, e.target.dataset.type, data);\n            }\n            if (e.target.dataset.action == \"delete\") {\n\n                confirmDeleteEntry(e);\n\n                // e.target.closest('tr').remove();\n                // deleteEntry(e.target.dataset.targetid);\n            }\n            e.target.removeAttribute('disabled');\n        }\n    });\n}\n\n/**\n * Renders template from jsonobject for the categoryid\n * @param {*} id\n * @param {*} data\n */\nfunction render(id, data) {\n    // Load the specific category data\n    let json = data[id];\n    // Select Container\n    let container = document.getElementById('local_wb_faq_admincontent');\n    // Render\n    Templates.renderForPromise('local_wb_faq/admincontent', json).then(({html}) => {\n        container.insertAdjacentHTML('beforeend', html);\n        return;\n    }).catch(e => {\n        // eslint-disable-next-line no-console\n        console.log(e);\n    });\n}\n\n/**\n * Renders template from asd for the categoryid\n * @param {*} id\n */\n export function deleteEntry(id) {\n    Ajax.call([{\n        methodname: \"local_wb_faq_delete_entry\",\n        args: {\n            'id': id\n        },\n        done: function() {\n\n            return;\n        },\n    }]);\n}\n\n/**\n * Renders template from asd for the categoryid\n * @param {*} id\n */\n export function toggleVisibility(id) {\n    Ajax.call([{\n        methodname: \"local_wb_faq_toggle_entry_visibility\",\n        args: {\n            'id': id\n        },\n        done: function() {\n\n            return;\n        },\n    }]);\n}\n\n/**\n * Render edit\n * @param {*} id\n * @param {*} type\n */\nfunction renderedit(id, type) {\n\n    let json = {'id': type + '-' + id};\n    let container = document.querySelector('#local_wb_faq_admin .view-' + type + '-' + id);\n    let editrow = '#local_wb_faq_admin .edit-' + type + '-' + id;\n    let td = '#local_wb_faq_admin .edit-' + type + '-' + id + ' td';\n    let hidden = 'hidden';\n    if (id == 0) {\n        editrow = '#local_wb_faq_admin #local_wb_faq_new_entry form';\n        container = document.querySelector('#local_wb_faq_new_entry');\n        td = '#local_wb_faq_admin #local_wb_faq_new_entry';\n        hidden = 'addnew';\n    }\n\n    Templates.renderForPromise('local_wb_faq/quickedit', json).then(({html}) => {\n        container.insertAdjacentHTML('afterend', html);\n        container.classList.add(hidden);\n        return;\n    }).then(() => {\n\n        let dynamicForm = null;\n\n        if (type == 1) {\n            dynamicForm = new DynamicForm(document.querySelector(td), 'local_wb_faq\\\\form\\\\editQuestionForm');\n        } else {\n            dynamicForm = new DynamicForm(document.querySelector(td), 'local_wb_faq\\\\form\\\\editCategoriesForm');\n        }\n        dynamicForm.load({\n            'id': id,\n            'type': type\n            });\n        return dynamicForm;\n    }).then((dynamicForm) => {\n        dynamicForm.addEventListener(dynamicForm.events.FORM_SUBMITTED, (e) => {\n            e.preventDefault();\n            container.classList.remove(hidden);\n            document.querySelector(editrow).remove();\n            window.location.reload();\n        });\n        dynamicForm.addEventListener(dynamicForm.events.FORM_CANCELLED, (e) => {\n            e.preventDefault();\n            container.classList.remove(hidden);\n            document.querySelector(editrow).remove();\n        });\n        return;\n    }).catch(e => {\n        // eslint-disable-next-line no-console\n        console.log(e);\n    });\n}\n\n/**\n *\n * @param {object} json\n */\nfunction renderforcache(json) {\n    Templates.renderForPromise('local_wb_faq/quickedit', json[1]);\n}\n"],"names":["_interopRequireDefault","obj","__esModule","default","id","Ajax","call","methodname","args","done","_ajax","_templates","_dynamicform","_exports","init","data","json","document","getElementById","addEventListener","e","target","hasAttribute","setAttribute","dataset","action","container","Templates","renderForPromise","then","_ref","html","insertAdjacentHTML","catch","console","log","render","targetid","type","querySelector","editrow","td","hidden","_ref2","classList","add","dynamicForm","DynamicForm","load","events","FORM_SUBMITTED","preventDefault","remove","window","location","reload","FORM_CANCELLED","renderedit","confirmDeleteEntry","removeAttribute","addEvents"],"mappings":"yKAwBgD,SAAAA,uBAAAC,YAAAA,KAAAA,IAAAC,WAAAD,KAAAE,QAAAF;;;;;kFAkExC,SAAqBG,IACzBC,cAAKC,KAAK,CAAC,CACPC,WAAY,4BACZC,KAAM,CACFJ,GAAMA,IAEVK,KAAM,gEAWN,SAA0BL,IAC9BC,cAAKC,KAAK,CAAC,CACPC,WAAY,uCACZC,KAAM,CACFJ,GAAMA,IAEVK,KAAM,iBA3FdC,MAAAV,uBAAAU,OACAC,WAAAX,uBAAAW,YACAC,aAAAZ,uBAAAY,cAWEC,SAAAC,KAJmBC,OAqJrB,IAAwBC,MA3IxB,SAAmBD,MACFE,SAASC,eAAe,sBAC9BC,iBAAiB,SAAUC,IAC1BA,EAAEC,OAAOC,aAAa,iBACtBF,EAAEC,OAAOE,aAAa,WAAY,YACH,QAA3BH,EAAEC,OAAOG,QAAQC,QAyBjC,SAAgBrB,GAAIW,MAEhB,IAAIC,KAAOD,KAAKX,IAEZsB,UAAYT,SAASC,eAAe,6BAExCS,mBAAUC,iBAAiB,4BAA6BZ,MAAMa,MAAKC,OAAY,IAAXC,KAACA,MAAKD,KACtEJ,UAAUM,mBAAmB,YAAaD,SAE3CE,OAAMb,IAELc,QAAQC,IAAIf,EAAE,IAlCNgB,CAAOhB,EAAEC,OAAOG,QAAQa,SAAUtB,MAEP,aAA3BK,EAAEC,OAAOG,QAAQC,QA2EjC,SAAoBrB,GAAIkC,MAEpB,IAAItB,KAAO,CAACZ,GAAMkC,KAAO,IAAMlC,IAC3BsB,UAAYT,SAASsB,cAAc,6BAA+BD,KAAO,IAAMlC,IAC/EoC,QAAU,6BAA+BF,KAAO,IAAMlC,GACtDqC,GAAK,6BAA+BH,KAAO,IAAMlC,GAAK,MACtDsC,OAAS,SACH,GAANtC,KACAoC,QAAU,mDACVd,UAAYT,SAASsB,cAAc,2BACnCE,GAAK,8CACLC,OAAS,UAGbf,mBAAUC,iBAAiB,yBAA0BZ,MAAMa,MAAKc,QAAY,IAAXZ,KAACA,MAAKY,MACnEjB,UAAUM,mBAAmB,WAAYD,MACzCL,UAAUkB,UAAUC,IAAIH,WAEzBb,MAAK,KAEJ,IAAIiB,YAAc,KAWlB,OARIA,YADQ,GAARR,KACc,IAAIS,qBAAY9B,SAASsB,cAAcE,IAAK,wCAE5C,IAAIM,qBAAY9B,SAASsB,cAAcE,IAAK,0CAE9DK,YAAYE,KAAK,CACb5C,GAAMA,GACNkC,KAAQA,OAELQ,WAAW,IACnBjB,MAAMiB,cACLA,YAAY3B,iBAAiB2B,YAAYG,OAAOC,gBAAiB9B,IAC7DA,EAAE+B,iBACFzB,UAAUkB,UAAUQ,OAAOV,QAC3BzB,SAASsB,cAAcC,SAASY,SAChCC,OAAOC,SAASC,QAAQ,IAE5BT,YAAY3B,iBAAiB2B,YAAYG,OAAOO,gBAAiBpC,IAC7DA,EAAE+B,iBACFzB,UAAUkB,UAAUQ,OAAOV,QAC3BzB,SAASsB,cAAcC,SAASY,QAAQ,OAG7CnB,OAAMb,IAELc,QAAQC,IAAIf,EAAE,IAxHNqC,CAAWrC,EAAEC,OAAOG,QAAQa,SAAUjB,EAAEC,OAAOG,QAAQc,MAE5B,UAA3BlB,EAAEC,OAAOG,QAAQC,SAEjB,EAAAiC,0BAAmBtC,GAKvBA,EAAEC,OAAOsC,gBAAgB,gBA5BjCC,CAAU7C,MAmJUC,KAlJLD,KAmJfY,mBAAUC,iBAAiB,yBAA0BZ,KAAK,GAnJtC,CAoJvB"}