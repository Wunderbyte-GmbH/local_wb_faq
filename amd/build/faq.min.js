define("local_wb_faq/faq",["exports","core/templates","core/str","core/ajax"],(function(_exports,_templates,_str,_ajax){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/*
   * @package    local_wunderbyte_table
   * @copyright  Wunderbyte GmbH <info@wunderbyte.at>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.reloadData=_exports.loadData=_exports.init=void 0,_templates=_interopRequireDefault(_templates),_ajax=_interopRequireDefault(_ajax);var clicks=0;const faqs={};function addEvents(data,root,uid){let select=document.querySelector(".local_wb_faq_container-"+uid);if(!select)return;select.listener&&select.removeEventListener("click",select.listener),select&&select.addEventListener("click",select.listener=e=>{!function(e){console.log(e.target.dataset.supplement,e.target.dataset.module);const moduleElement=document.querySelector("#local_edusupport_create_form #id_module"),supplementElement=document.querySelector("#local_edusupport_create_form #id_supplement");moduleElement&&(console.log(e.target.dataset.module),moduleElement.value=e.target.dataset.module);supplementElement&&(console.log(e.target.dataset.supplement),supplementElement.value=e.target.dataset.supplement)}(e);let button=e.target;"faqcollapse"==button.dataset.toggle&&(clicks++,console.log(clicks),button.classList.contains("collapsed")?(button.classList.remove("collapsed"),document.querySelector(button.dataset.target).classList.add("show"),document.querySelector(button.dataset.target).classList.remove("hide")):(button.classList.add("collapsed"),document.querySelector(button.dataset.target).classList.add("hide"),document.querySelector(button.dataset.target).classList.remove("show"))),"goto"==e.target.dataset.action&&render(e.target.dataset.targetid,data,uid)});let searchbox=document.querySelector(".wb_faq_searchbox-"+uid);console.log("searchbox",searchbox),searchbox&&searchbox.addEventListener("click",(e=>{let button=e.target;"faqcollapse"==button.dataset.toggle&&(clicks++,button.classList.contains("collapsed")?(button.classList.remove("collapsed"),document.querySelector(button.dataset.target).classList.add("show"),document.querySelector(button.dataset.target).classList.remove("hide")):(button.classList.add("collapsed"),document.querySelector(button.dataset.target).classList.add("hide"),document.querySelector(button.dataset.target).classList.remove("show"))),"goto"==e.target.dataset.action&&(render(e.target.dataset.targetid,data,uid),document.querySelector(".local_wb_faq-"+uid).scrollIntoView({block:"start",behavior:"smooth"}))}));let category=document.querySelector("#id_categorypicker");category&&category.addEventListener("change",(()=>{let faqid=category.value;""==category.value&&(faqid=root),render(faqid,data)}))}function render(id,data,uid){let templatedata=JSON.parse(data)[id];if(templatedata.root=id,templatedata.uid=uid,!templatedata||!templatedata.hasOwnProperty("parentid"))return;""==templatedata.parentid&&(templatedata.parenttitle=(0,_str.get_string)("faq","local_wb_faq"));let container=document.querySelector(".local_wb_faq-"+uid);container&&(container.innerHTML="",_templates.default.renderForPromise("local_wb_faq/faq",templatedata).then((_ref=>{let{html:html,js:js}=_ref;_templates.default.replaceNodeContents(".local_wb_faq-"+uid,html,js)})).catch((e=>{console.log(e)})))}_exports.init=(data,root,uid)=>{clicks=0,faqs[uid]||(faqs[uid]=!0,console.log("faq.js ",uid,root,data),render(root,data,uid),addEvents(data,root,uid))};_exports.reloadData=(uid,parentid)=>{loadData(uid,parentid)};const loadData=(uid,parentid)=>_ajax.default.call([{methodname:"local_wb_faq_get_faq_data",args:{},done:function(data){let newdata=JSON.parse(data.json);return uid?(addEvents(newdata,parentid,uid),render(parentid,newdata,uid),""):newdata},fail:function(ex){console.log(ex)}}]);_exports.loadData=loadData}));

//# sourceMappingURL=faq.min.js.map