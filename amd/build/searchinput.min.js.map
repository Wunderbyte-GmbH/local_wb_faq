{"version":3,"file":"searchinput.min.js","sources":["../src/searchinput.js"],"sourcesContent":["\r\n// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/*\r\n * @package    local_wunderbyte_table\r\n * @copyright  Wunderbyte GmbH <info@wunderbyte.at>\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\nimport Templates from 'core/templates';\r\nimport {get_string as getString} from 'core/str';\r\n\r\nvar searcharray = [];\r\n\r\nexport const searchInput = (inputClass, elementToHide, elementToSearch, uid) => {\r\n    let input, filter, li, a, i, txtValue;\r\n    input = document.querySelector(inputClass);\r\n    filter = input.value.toUpperCase();\r\n    li = document.querySelectorAll(elementToHide);\r\n    for (i = 0; i < li.length; i++) {\r\n        a = li[i].querySelector(elementToSearch);\r\n        txtValue = a.textContent || a.innerText;\r\n\r\n        if (txtValue.toUpperCase().indexOf(filter) > -1) {\r\n            li[i].style.display = \"\";\r\n        } else {\r\n            li[i].style.display = \"none\";\r\n        }\r\n    }\r\n};\r\n\r\nexport const searchJSON = (listContainer, inputClass, json) => {\r\n    let arr = [];\r\n    // Select Container\r\n    // eslint-disable-next-line no-console\r\n    console.log(listContainer, inputClass);\r\n    let container = document.querySelector(listContainer);\r\n\r\n    let searchVal = document.querySelector(inputClass).value.toUpperCase();\r\n\r\n    // eslint-disable-next-line no-console\r\n    console.log(searchVal);\r\n    if (searchVal.length > 3) {\r\n        let i = 0;\r\n        Object.values(json).forEach(e=>{\r\n             if ((e.content && e.content.toUpperCase().indexOf(searchVal) > -1)\r\n                || (e.title && e.title.toUpperCase().indexOf(searchVal) > -1)) {\r\n                arr[i] = e;\r\n                if (e.type == 0) {\r\n                    arr[i].iscategory = true;\r\n                }\r\n                i++;\r\n            }\r\n        });\r\n\r\n        for (let i = 0; i < arr.length; i++) {\r\n\r\n            if (typeof searcharray[i] === 'undefined') {\r\n                render(arr, container);\r\n                break;\r\n            }\r\n\r\n            if (arr[i].id != searcharray[i].id) {\r\n\r\n                render(arr, container);\r\n                break;\r\n            }\r\n        }\r\n        searcharray = arr;\r\n\r\n        if (searcharray.length < 1) {\r\n            getString('noresult', 'local_wb_faq').then(value => {\r\n\r\n                // eslint-disable-next-line no-console\r\n                console.log(value);\r\n                container.innerHTML = value;\r\n                return;\r\n            }).catch(e => {\r\n                // eslint-disable-next-line no-console\r\n                console.log(e);\r\n            });\r\n        }\r\n\r\n    } else if (searchVal.length == 0) {\r\n\r\n        container.innerHTML = '';\r\n        searcharray = [];\r\n\r\n    } else {\r\n\r\n        getString('stringtooshort', 'local_wb_faq').then(value => {\r\n\r\n            // eslint-disable-next-line no-console\r\n            console.log(value);\r\n            container.innerHTML = value;\r\n            return;\r\n        }).catch(e => {\r\n            // eslint-disable-next-line no-console\r\n            console.log(e);\r\n        });\r\n\r\n        searcharray = [];\r\n\r\n    }\r\n};\r\n\r\nexport const init = (searchInputID, listContainer, elementToHide, elementToSearch, json = null) => {\r\n    // eslint-disable-next-line no-console\r\n    console.log(\"initSearch\", searchInputID, listContainer);\r\n    document.querySelector(searchInputID).addEventListener('keyup', function () {\r\n        searchJSON(listContainer, searchInputID, json);\r\n    });\r\n};\r\n\r\n\r\nexport const render = (data, container) => {\r\n    // Render\r\n    // eslint-disable-next-line no-console\r\n    console.log(container);\r\n\r\n    Templates.renderForPromise('local_wb_faq/searchbox', data).then(({html}) => {\r\n        container.innerHTML = \"\";\r\n        container.insertAdjacentHTML('afterbegin', html);\r\n        return;\r\n    }).catch(e => {\r\n        // eslint-disable-next-line no-console\r\n        console.log(e);\r\n    });\r\n};"],"names":["searcharray","inputClass","elementToHide","elementToSearch","uid","input","filter","li","a","i","txtValue","document","querySelector","value","toUpperCase","querySelectorAll","length","textContent","innerText","indexOf","style","display","searchJSON","listContainer","json","arr","console","log","container","searchVal","Object","values","forEach","e","content","title","type","iscategory","render","id","then","innerHTML","catch","searchInputID","addEventListener","data","renderForPromise","_ref","html","insertAdjacentHTML"],"mappings":";;;;;6MAwBIA,YAAc,wBAES,CAACC,WAAYC,cAAeC,gBAAiBC,WAChEC,MAAOC,OAAQC,GAAIC,EAAGC,EAAGC,aAC7BL,MAAQM,SAASC,cAAcX,YAC/BK,OAASD,MAAMQ,MAAMC,cACrBP,GAAKI,SAASI,iBAAiBb,eAC1BO,EAAI,EAAGA,EAAIF,GAAGS,OAAQP,IACvBD,EAAID,GAAGE,GAAGG,cAAcT,iBACxBO,SAAWF,EAAES,aAAeT,EAAEU,UAE1BR,SAASI,cAAcK,QAAQb,SAAW,EAC1CC,GAAGE,GAAGW,MAAMC,QAAU,GAEtBd,GAAGE,GAAGW,MAAMC,QAAU,cAKrBC,WAAa,CAACC,cAAetB,WAAYuB,YAC9CC,IAAM,GAGVC,QAAQC,IAAIJ,cAAetB,gBACvB2B,UAAYjB,SAASC,cAAcW,eAEnCM,UAAYlB,SAASC,cAAcX,YAAYY,MAAMC,iBAGzDY,QAAQC,IAAIE,WACRA,UAAUb,OAAS,EAAG,KAClBP,EAAI,EACRqB,OAAOC,OAAOP,MAAMQ,SAAQC,KAClBA,EAAEC,SAAWD,EAAEC,QAAQpB,cAAcK,QAAQU,YAAc,GACzDI,EAAEE,OAASF,EAAEE,MAAMrB,cAAcK,QAAQU,YAAc,KAC3DJ,IAAIhB,GAAKwB,EACK,GAAVA,EAAEG,OACFX,IAAIhB,GAAG4B,YAAa,GAExB5B,YAIH,IAAIA,EAAI,EAAGA,EAAIgB,IAAIT,OAAQP,IAAK,SAEH,IAAnBT,YAAYS,GAAoB,CACvC6B,OAAOb,IAAKG,oBAIZH,IAAIhB,GAAG8B,IAAMvC,YAAYS,GAAG8B,GAAI,CAEhCD,OAAOb,IAAKG,mBAIpB5B,YAAcyB,KAEET,OAAS,uBACX,WAAY,gBAAgBwB,MAAK3B,QAGvCa,QAAQC,IAAId,OACZe,UAAUa,UAAY5B,SAEvB6B,OAAMT,IAELP,QAAQC,IAAIM,WAIO,GAApBJ,UAAUb,QAEjBY,UAAUa,UAAY,GACtBzC,YAAc,yBAIJ,iBAAkB,gBAAgBwC,MAAK3B,QAG7Ca,QAAQC,IAAId,OACZe,UAAUa,UAAY5B,SAEvB6B,OAAMT,IAELP,QAAQC,IAAIM,MAGhBjC,YAAc,kDAKF,SAAC2C,cAAepB,cAAerB,cAAeC,qBAAiBqB,4DAAO,KAEtFE,QAAQC,IAAI,aAAcgB,cAAepB,eACzCZ,SAASC,cAAc+B,eAAeC,iBAAiB,SAAS,WAC5DtB,WAAWC,cAAeoB,cAAenB,gBAKpCc,OAAS,CAACO,KAAMjB,aAGzBF,QAAQC,IAAIC,8BAEFkB,iBAAiB,yBAA0BD,MAAML,MAAKO,WAACC,KAACA,WAC9DpB,UAAUa,UAAY,GACtBb,UAAUqB,mBAAmB,aAAcD,SAE5CN,OAAMT,IAELP,QAAQC,IAAIM"}