{"version":3,"file":"supportmessage_form.min.js","sources":["../src/supportmessage_form.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @package    local_wb_faq\n * @copyright  Wunderbyte GmbH <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport DynamicForm from 'core_form/dynamicform';\n\nconst SELECTORS = {\n    SUPPORTMESSAGEFORM: \"[data-id='supportmessage-form']\",\n    THANKYOUTAB: '#faq-nav-pillsthree-tab',\n};\n\n/**\n * Initialize the form with event listener that update url params.\n */\nexport const init = () => {\n\n    // eslint-disable-next-line no-console\n    console.log('init');\n\n    const elements = document.querySelectorAll(SELECTORS.SUPPORTMESSAGEFORM);\n\n    // eslint-disable-next-line no-console\n    console.log('elements');\n\n    elements.forEach(element => {\n        listenToSelect(element);\n    });\n};\n\n/**\n * Set an eventlistener for a select.\n *  @param {*} element\n *\n */\nexport function listenToSelect(element) {\n        // Initialize the form - pass the container element and the form class name.\n        const dynamicForm = new DynamicForm(\n            element,\n            'local_wb_faq\\\\form\\\\supportmessage');\n\n        // eslint-disable-next-line no-console\n        console.log(dynamicForm);\n\n        dynamicForm.load();\n\n        // If a user selects a context, redirect to a URL that includes the selected\n        // context as `contextid` query parameter\n        dynamicForm.addEventListener(dynamicForm.events.FORM_SUBMITTED, (e) => {\n\n            // eslint-disable-next-line no-console\n            console.log(\"submitted\", e);\n\n            const tab = document.querySelector(SELECTORS.THANKYOUTAB);\n            tab.classList.remove('disabled');\n            tab.click();\n        });\n\n        dynamicForm.addEventListener('change', (e) => {\n            // eslint-disable-next-line no-console\n            console.log(\"change\", e, e.target.name);\n\n            if (e.target.name == 'groupname') {\n\n                e.preventDefault();\n\n                let button = document.querySelector('[name=\"submitmodulechoice\"]');\n                button.click();\n            }\n        });\n}\n"],"names":["SELECTORS","listenToSelect","element","dynamicForm","DynamicForm","console","log","load","addEventListener","events","FORM_SUBMITTED","e","tab","document","querySelector","classList","remove","click","target","name","preventDefault","elements","querySelectorAll","forEach"],"mappings":";;;;;iMAuBMA,6BACkB,kCADlBA,sBAEW,mCA0BDC,eAAeC,eAEjBC,YAAc,IAAIC,qBACpBF,QACA,sCAGJG,QAAQC,IAAIH,aAEZA,YAAYI,OAIZJ,YAAYK,iBAAiBL,YAAYM,OAAOC,gBAAiBC,IAG7DN,QAAQC,IAAI,YAAaK,SAEnBC,IAAMC,SAASC,cAAcd,uBACnCY,IAAIG,UAAUC,OAAO,YACrBJ,IAAIK,WAGRd,YAAYK,iBAAiB,UAAWG,OAEpCN,QAAQC,IAAI,SAAUK,EAAGA,EAAEO,OAAOC,MAEb,aAAjBR,EAAEO,OAAOC,KAAqB,CAE9BR,EAAES,iBAEWP,SAASC,cAAc,+BAC7BG,0BApDH,KAGhBZ,QAAQC,IAAI,cAENe,SAAWR,SAASS,iBAAiBtB,8BAG3CK,QAAQC,IAAI,YAEZe,SAASE,SAAQrB,UACbD,eAAeC"}