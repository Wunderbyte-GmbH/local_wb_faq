{"version":3,"sources":["../src/admin.js"],"names":["init","data","addEvents","renderforcache","select","document","getElementById","addEventListener","e","target","hasAttribute","setAttribute","dataset","action","render","targetid","renderedit","type","closest","remove","deleteentry","removeAttribute","id","json","container","Templates","renderForPromise","then","html","insertAdjacentHTML","catch","console","log","Ajax","call","methodname","args","done","querySelector","editrow","td","hidden","classList","add","dynamicForm","DynamicForm","load","events","FORM_SUBMITTED","preventDefault","window","location","reload","FORM_CANCELLED"],"mappings":"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","sourcesContent":["\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @package    local_wunderbyte_table\n * @copyright  Wunderbyte GmbH <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\nimport Templates from 'core/templates';\nimport DynamicForm from 'core_form/dynamicform';\n\n/**\n * Gets called from mustache template.\n *\n */\nexport const init = (data) => {\n\n    addEvents(data);\n    renderforcache(data);\n};\n\n/**\n * adds Evente to toggle switch\n */\nfunction addEvents(data) {\n    let select = document.getElementById('local_wb_faq_admin');\n    select.addEventListener('click', (e) => {\n        if (e.target.hasAttribute('data-action')) {\n            e.target.setAttribute('disabled', 'disabled');\n            if (e.target.dataset.action == \"goto\") {\n\n                render(e.target.dataset.targetid, data);\n            }\n            if (e.target.dataset.action == \"quickedit\") {\n\n                renderedit(e.target.dataset.targetid, e.target.dataset.type, data);\n            }\n            if (e.target.dataset.action == \"delete\") {\n                e.target.closest('tr').remove();\n                deleteentry(e.target.dataset.targetid);\n            }\n            e.target.removeAttribute('disabled');\n        }\n    });\n}\n\n/**\n * Renders template from jsonobject for the categoryid\n * @param {*} id\n */\nfunction render(id, data) {\n    // Load the specific category data\n    let json = data[id];\n    // Select Container\n    let container = document.getElementById('local_wb_faq_admincontent');\n    // Render\n    Templates.renderForPromise('local_wb_faq/admincontent', json).then(({html}) => {\n        container.insertAdjacentHTML('beforeend', html);\n    }).catch(e => {\n        // eslint-disable-next-line no-console\n        console.log(e);\n    });\n}\n\n/**\n * Renders template from asd for the categoryid\n * @param {*} id\n */\n export const deleteentry = (id) => {\n    Ajax.call([{\n        methodname: \"local_wb_faq_delete_entry\",\n        args: {\n            'id' : id\n        },\n        done: function() {\n        },\n    }]);\n};\n\n\n\nfunction renderedit(id, type) {\n    let json = {'id' : type + '-' + id};\n    let  container = document.querySelector('#local_wb_faq_admin .view-' + type + '-' + id);\n    let editrow = '#local_wb_faq_admin .edit-' + type + '-' + id;\n    let td = '#local_wb_faq_admin .edit-' + type + '-' + id + ' td';\n    let hidden = 'hidden';\n    if (id == 0) {\n        editrow = '#local_wb_faq_admin #local_wb_faq_new_entry form';\n        container = document.querySelector('#local_wb_faq_new_entry');\n        td = '#local_wb_faq_admin #local_wb_faq_new_entry';\n        hidden = 'addnew';\n    }\n\n    Templates.renderForPromise('local_wb_faq/quickedit', json).then(({html}) => {\n        container.insertAdjacentHTML('afterend', html);\n        container.classList.add(hidden);\n    }).then(() =>  {\n    let dynamicForm = new DynamicForm(document.querySelector(td), 'local_wb_faq\\\\form\\\\dynamiceditform');\n    dynamicForm.load({\n        'id' : id,\n        'type' : type\n        });\n    return dynamicForm;\n    }).then((dynamicForm) => {\n        dynamicForm.addEventListener(dynamicForm.events.FORM_SUBMITTED, (e) => {\n            e.preventDefault();\n            container.classList.remove(hidden);\n            document.querySelector(editrow).remove();\n            window.location.reload();\n        });\n        dynamicForm.addEventListener(dynamicForm.events.FORM_CANCELLED, (e) => {\n            e.preventDefault();\n            container.classList.remove(hidden);\n            document.querySelector(editrow).remove();\n        });\n    });\n}\n\n/**\n *\n * @param {object} json\n */\nfunction renderforcache(json) {\n    Templates.renderForPromise('local_wb_faq/quickedit', json[1]);\n}\n"],"file":"admin.min.js"}