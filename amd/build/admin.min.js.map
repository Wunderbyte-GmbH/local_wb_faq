{"version":3,"file":"admin.min.js","sources":["../src/admin.js"],"sourcesContent":["\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @package    local_wunderbyte_table\n * @copyright  Wunderbyte GmbH <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\nimport Templates from 'core/templates';\nimport DynamicForm from 'core_form/dynamicform';\n\n/**\n * Gets called from mustache template.\n *\n */\nexport const init = (data, startid) => {\n    console.log(data);\n    console.log(startid);\n    addEvents(data);\n    renderforcache(data);\n};\n\n/**\n * adds Evente to toggle switch\n */\nfunction addEvents(data) {\n    let select = document.getElementById('local_wb_faq_admin');\n    select.addEventListener('click', (e) => {\n        if (e.target.hasAttribute('data-action')) {\n            e.target.setAttribute('disabled', 'disabled');\n            if (e.target.dataset.action == \"goto\") {\n                console.log(\"goto\");\n                render(e.target.dataset.targetid, data);\n            }\n            if (e.target.dataset.action == \"quickedit\") {\n                console.log(\"quickedit\");\n                renderedit(e.target.dataset.targetid, e.target.dataset.type, data);\n            }\n            if (e.target.dataset.action == \"delete\") {\n                e.target.closest('tr').remove();\n                deleteentry(e.target.dataset.targetid);\n            }\n            e.target.removeAttribute('disabled');\n        }\n    });\n}\n\n/**\n * Renders template from jsonobject for the categoryid\n * @param {*} id\n */\nfunction render(id, data) {\n    // Load the specific category data\n    let json = data[id];\n    // Select Container\n    let container = document.getElementById('local_wb_faq_admincontent');\n    // Render\n    Templates.renderForPromise('local_wb_faq/admincontent', json).then(({html}) => {\n        container.insertAdjacentHTML('beforeend', html);\n    });\n};\n\n/**\n * Renders template from asd for the categoryid\n * @param {*} id\n */\n export const deleteentry = (id) => {\n    console.log('delete' + id);\n    Ajax.call([{\n        methodname: \"local_wb_faq_delete_entry\",\n        args: {\n            'id' : id\n        },\n        done: function() {\n            console.log(\"\");\n        },\n    }]);\n}\n\n\n\nfunction renderedit(id, type, data) {\n    let json = {'id' : type + '-' + id};\n    let  container = document.querySelector('#local_wb_faq_admin .view-' + type + '-' + id);\n    let editrow = '#local_wb_faq_admin .edit-' + type + '-' + id;\n    let td = '#local_wb_faq_admin .edit-' + type + '-' + id + ' td';\n    let hidden = 'hidden';\n    if (id == 0) {\n        console.log('id 0');\n        editrow = '#local_wb_faq_admin #local_wb_faq_new_entry form';\n        container = document.querySelector('#local_wb_faq_new_entry');\n        td = '#local_wb_faq_admin #local_wb_faq_new_entry';\n        type = 'edit';\n        hidden = 'addnew';\n    }\n\n    Templates.renderForPromise('local_wb_faq/quickedit', json).then(({html}) => {\n        container.insertAdjacentHTML('afterend', html);\n        container.classList.add(hidden);\n    }).then(() =>  {\n    let dynamicForm = new DynamicForm(document.querySelector(td), 'local_wb_faq\\\\form\\\\dynamiceditform');\n    dynamicForm.load({'id' : id});\n    console.log(\"dynamis\");\n    return dynamicForm;\n    }).then((dynamicForm) => {\n        dynamicForm.addEventListener(dynamicForm.events.FORM_SUBMITTED, (e) => {\n            e.preventDefault();\n            const response = e.detail;\n            container.classList.remove(hidden);\n            console.log(response);\n            document.querySelector(editrow).remove();\n            console.log(\"refresh\");\n            window.location.reload();\n        });\n        dynamicForm.addEventListener(dynamicForm.events.FORM_CANCELLED, (e) => {\n            e.preventDefault();\n            container.classList.remove(hidden);\n            document.querySelector(editrow).remove();\n        });\n    });\n}\n\nfunction renderforcache(json) {\n    Templates.renderForPromise('local_wb_faq/quickedit', json[1]).then(({html}) => {\n        html = \"\";\n    });\n}\n"],"names":["data","startid","json","console","log","document","getElementById","addEventListener","e","target","hasAttribute","setAttribute","dataset","action","id","container","renderForPromise","then","_ref","html","insertAdjacentHTML","render","targetid","type","querySelector","editrow","td","hidden","_ref2","classList","add","dynamicForm","DynamicForm","load","events","FORM_SUBMITTED","preventDefault","response","detail","remove","window","location","reload","FORM_CANCELLED","renderedit","closest","deleteentry","removeAttribute","addEvents","_ref3","call","methodname","args","done"],"mappings":";;;;;yPA8BoB,CAACA,KAAMC,eA2GHC,KA1GpBC,QAAQC,IAAIJ,MACZG,QAAQC,IAAIH,kBAQGD,MACFK,SAASC,eAAe,sBAC9BC,iBAAiB,SAAUC,IAC1BA,EAAEC,OAAOC,aAAa,iBACtBF,EAAEC,OAAOE,aAAa,WAAY,YACH,QAA3BH,EAAEC,OAAOG,QAAQC,SACjBV,QAAQC,IAAI,iBAoBZU,GAAId,UAEZE,KAAOF,KAAKc,IAEZC,UAAYV,SAASC,eAAe,gDAE9BU,iBAAiB,4BAA6Bd,MAAMe,MAAKC,WAACC,KAACA,WACjEJ,UAAUK,mBAAmB,YAAaD,SA1BlCE,CAAOb,EAAEC,OAAOG,QAAQU,SAAUtB,OAEP,aAA3BQ,EAAEC,OAAOG,QAAQC,SACjBV,QAAQC,IAAI,sBA8CRU,GAAIS,KAAMvB,UACtBE,KAAO,IAAQqB,KAAO,IAAMT,IAC3BC,UAAYV,SAASmB,cAAc,6BAA+BD,KAAO,IAAMT,IAChFW,QAAU,6BAA+BF,KAAO,IAAMT,GACtDY,GAAK,6BAA+BH,KAAO,IAAMT,GAAK,MACtDa,OAAS,SACH,GAANb,KACAX,QAAQC,IAAI,QACZqB,QAAU,mDACVV,UAAYV,SAASmB,cAAc,2BACnCE,GAAK,8CACLH,KAAO,OACPI,OAAS,6BAGHX,iBAAiB,yBAA0Bd,MAAMe,MAAKW,YAACT,KAACA,YAC9DJ,UAAUK,mBAAmB,WAAYD,MACzCJ,UAAUc,UAAUC,IAAIH,WACzBV,MAAK,SACJc,YAAc,IAAIC,qBAAY3B,SAASmB,cAAcE,IAAK,8CAC9DK,YAAYE,KAAK,IAAQnB,KACzBX,QAAQC,IAAI,WACL2B,eACJd,MAAMc,cACLA,YAAYxB,iBAAiBwB,YAAYG,OAAOC,gBAAiB3B,IAC7DA,EAAE4B,uBACIC,SAAW7B,EAAE8B,OACnBvB,UAAUc,UAAUU,OAAOZ,QAC3BxB,QAAQC,IAAIiC,UACZhC,SAASmB,cAAcC,SAASc,SAChCpC,QAAQC,IAAI,WACZoC,OAAOC,SAASC,YAEpBX,YAAYxB,iBAAiBwB,YAAYG,OAAOS,gBAAiBnC,IAC7DA,EAAE4B,iBACFrB,UAAUc,UAAUU,OAAOZ,QAC3BtB,SAASmB,cAAcC,SAASc,eAjF5BK,CAAWpC,EAAEC,OAAOG,QAAQU,SAAUd,EAAEC,OAAOG,QAAQW,OAE5B,UAA3Bf,EAAEC,OAAOG,QAAQC,SACjBL,EAAEC,OAAOoC,QAAQ,MAAMN,SACvBO,YAAYtC,EAAEC,OAAOG,QAAQU,WAEjCd,EAAEC,OAAOsC,gBAAgB,gBAxBjCC,CAAUhD,MAwGUE,KAvGLF,wBAwGLgB,iBAAiB,yBAA0Bd,KAAK,IAAIe,MAAKgC,YAAC9B,KAACA,YACjEA,KAAO,aA1DD2B,YAAehC,KACzBX,QAAQC,IAAI,SAAWU,kBAClBoC,KAAK,CAAC,CACPC,WAAY,4BACZC,KAAM,IACKtC,IAEXuC,KAAM,WACFlD,QAAQC,IAAI"}