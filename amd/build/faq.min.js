define("local_wb_faq/faq",["exports","core/templates","core/str","core/ajax"],(function(_exports,_templates,_str,_ajax){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/*
   * @package    local_wunderbyte_table
   * @copyright  Wunderbyte GmbH <info@wunderbyte.at>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.reloadData=_exports.init=void 0,_templates=_interopRequireDefault(_templates),_ajax=_interopRequireDefault(_ajax);var clicks=0;function addEvents(data,root,uid){let select=document.querySelector(".local_wb_faq_container-"+uid);select.listener&&select.removeEventListener("click",select.listener),select&&select.addEventListener("click",select.listener=e=>{let button=e.target;"faqcollapse"==button.dataset.toggle&&(clicks++,console.log(clicks),button.classList.contains("collapsed")?(button.classList.remove("collapsed"),document.querySelector(button.dataset.target).classList.add("show"),document.querySelector(button.dataset.target).classList.remove("hide")):(button.classList.add("collapsed"),document.querySelector(button.dataset.target).classList.add("hide"),document.querySelector(button.dataset.target).classList.remove("show"))),"goto"==e.target.dataset.action&&render(e.target.dataset.targetid,data,uid)});let searchbox=document.querySelector(".wb_faq_searchbox-"+uid);console.log("searchbox",searchbox),searchbox&&searchbox.addEventListener("click",(e=>{let button=e.target;"faqcollapse"==button.dataset.toggle&&(clicks++,button.classList.contains("collapsed")?(button.classList.remove("collapsed"),document.querySelector(button.dataset.target).classList.add("show"),document.querySelector(button.dataset.target).classList.remove("hide")):(button.classList.add("collapsed"),document.querySelector(button.dataset.target).classList.add("hide"),document.querySelector(button.dataset.target).classList.remove("show"))),"goto"==e.target.dataset.action&&(render(e.target.dataset.targetid,data,uid),document.querySelector(".local_wb_faq-"+uid).scrollIntoView({block:"start",behavior:"smooth"}))}));let category=document.querySelector("#id_categorypicker");category&&category.addEventListener("change",(()=>{let faqid=category.value;""==category.value&&(faqid=root),render(faqid,data)}))}function render(id,data,uid){let templatedata=JSON.parse(data)[id];templatedata.root=id,templatedata.uid=uid,templatedata&&templatedata.hasOwnProperty("parentid")&&(""==templatedata.parentid&&(templatedata.parenttitle=(0,_str.get_string)("faq","local_wb_faq")),document.querySelector(".local_wb_faq-"+uid).innerHTML="",_templates.default.renderForPromise("local_wb_faq/faq",templatedata).then((_ref=>{let{html:html,js:js}=_ref;html='<div class="local_wb_faq-'+uid+'">'+html+"</div>",_templates.default.replaceNode(".local_wb_faq-"+uid,html,js)})).catch((e=>{console.log(e)})))}_exports.init=(data,root,uid)=>{clicks=0,console.log("faq.js ",uid),render(root,data,uid),addEvents(data,root,uid)};_exports.reloadData=(uid,parentid)=>{loadData(uid,parentid)};const loadData=(uid,parentid)=>_ajax.default.call([{methodname:"local_wb_faq_get_faq_data",args:{},done:function(data){let newdata=JSON.parse(data.json);addEvents(newdata,parentid,uid),render(parentid,newdata,uid)},fail:function(ex){console.log(ex)}}])}));

//# sourceMappingURL=faq.min.js.map